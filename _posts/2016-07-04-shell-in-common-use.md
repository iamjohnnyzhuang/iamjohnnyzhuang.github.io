---
clayout: post
title: 学会这些Shell命令就够了
categories: [shell]
---

# 关于这篇文章
学习Linux的童鞋相信都是从常用的Linux命令开始学习的吧。但是总会遇到和博主一样的问题：基本的Linux命令（如cd、rm、mv等等）学会了，但总感觉还是对Linxu很生疏。遇到一些特殊一点的情况就又得到处去google。所以我写这篇文章打算纪录一些工作中常见到的Shell命令。这样以后就不用再在用的时候到处去Google了。此外，对这些命令进行一些简单的分析，以小见到，从这些命令中来加深对Linxu以及Shell的理解。此篇文章保持长期更新。

# 系统环境
虽然是针对Linux的，但是由于答主的电脑用的是Mac OS以及Zsh，因此这里主要是以Mac Os + Zsh为主，但是和Linux + Bash 没多大区别哦！

# 常用场景
**1. 查找指定目录下的文件，这些文件要包含指定字符串**

有修改过Wordpress等网站且不擅长PHP没用IDE的童鞋肯定遇到过这样的问题：通过前端Chrome找到某个需要修改的前端代码片段（比如模板写的是power by johnny-zhuang）对于使用模板的人肯定不想暴露自己的网站使用了谁的模板吧。这个时候就会想去修改这段代码。

但是没有IDE，我们虽然知道了这段代码的关键字（如power by johnny-zhuang）怎么去寻找它出现在哪呢？

这个时候我们可以借助Shell的find和grep操作。先给出这个问题的解答。

``` shell
find . | xargs grep -r "power by johnny-zhuang"
```

find 操作查找当前目录下的所有文件，然后经过xargs操作。为什么用xargs操作呢？

>   它的作用是将参数列表转换成小块分段传递给其他命令，以避免参数列表过长的问题。 （维基百科）

简而言之使用了xargs防止搜索的文件列表太长的情况。

对于每个小片段进行grep操作。加入-r操作让grep可以进行递归搜索。这里grep直接搜索想要的字符串。如果要搜索的是正则表达式可以用

``` shell
grep -e  "正则表达式"
```

到此为止，第一个使用命令就讲完啦。通过这个场景我们可以学会find 以及 grep xargs 的基础操作了。

----

**2.日期转换**

我们在工作的时候经常会涉及到日期date的操作。关于date很简单，主要是要用到三种。最简单的一种就是简单的直接输出当前日期：

``` shell	
date
#输出当前时间  2016年07月20日 10:40:20  
```

这样的日期很显然但是显然不适合让机器去读。机器为了比较我们经常会将他们转化成时间戳。

> 时间戳是指格林威治时间1970年01月01日00时00分00秒(北京时间1970年01月01日08时00分00秒)起至现在的总毫秒数。   —— 维基百科
>

Shell也提供了很方便的将时间转化为时间戳操作： 

```shell
date +"%s"
#输出时间戳  1468983374
```

同时我们也经常会做的是将日期进行格式化输出。如下所示：

``` shell
 date +"%Y-%m-%d %H:%m:%S"
 #格式化输出 2016-07-20 10:07:23
```

---

**3.日志输出控制**

日志在Linux中起到非常重要的角色。特别是Server的Linux系统。因为没有界面，想要维护线上机器唯一的途径就是监视Log文件。

但是，我们知道一个App每天从早到晚打出来的Log非常多，打到文件占用的CPU/IO就不提了，打到控制台上没人看也是非常浪费资源的（如果你在Linux下执行一些操作应该会在终端里也就是控制台看到Log信息的）。所以，对于一些不常用的命令我们应该让他们彻底不打出来。

>  **/dev/null**可以理解为系统里的一个黑洞，到这里来的东西都会消失掉。

我们做个最简单的模拟。

```shell
java -jar app > "./test"
java -jar app
java -jar app > /dev/null
java -jar app > /dev/null 2>&1
```

上面四个语句:

* 第一个将log输出到test文件里。
* 第二个将log内容输出到控制台
* 第三个讲log标准输出输出到 /dev/null 里即永远不输出任何东西
* 第四个将log里的标准输出和标准错误输出都送到/dev/null里即永远不输出

前三个都很好理解，那么第四个什么意思呢？**在Linux中，标准输出用1表示，标准错误输出用2表示**。所以第四句和第三句一样的部分表示将标准输出输出到/dev/null里，后半句是将标准错误输出重定向到标准输出里即/dev/null。

标准输出以及标准错误输出维基百科定义如下：

**标准输出(stout)**

> 标准输出是指程序写输出数据的流。程序要求数据传输使用*写*的运算。并非所有程序都要求输出。如*mv*或*ren*程序在成功完成时是沉默的。
>

**标准错误输出(stderr)** 

> 标准错误输出是另一输出流，用于输出错误消息或诊断。它独立于标准输出，且可以分别被重导。常见的目的则为启始这个程序的[终端](https://zh.wikipedia.org/wiki/%E7%B5%82%E7%AB%AF)，即使其*标准输出*被重导亦如此。例如：一个管线中的程序的输出被重导到下一个程序，但错误消息仍然直接流向文字终端机。
>